<div class="square-map-container">
  <div #rendererContainer id="rendererContainer"></div>
  <div class="filters">
    
    <!-- Map Legend -->
    <div class="map-legend" style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 8px; border: 2px solid #dee2e6;">
      <h4 style="margin-top: 0; margin-bottom: 15px; color: #495057; text-align: center;">üó∫Ô∏è Biome & Terrain Legend</h4>
      
      <!-- Water Biomes -->
      <div style="margin-bottom: 15px;">
        <h5 style="margin-bottom: 10px; color: #0066cc; border-bottom: 2px solid #0066cc; padding-bottom: 5px;">üíß Water Bodies</h5>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #20a0ff; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Saltwater (Oceans/Seas)</strong><br>
              {{ getActualBiomePercentage('saltwater').toFixed(1) }}% 
              <span *ngIf="enforceEarthQuotas" style="color: #666;">(Target: {{ getTargetBiomePercentage('saltwater').toFixed(1) }}%) {{ getQuotaStatus('saltwater') }}</span><br>
              ({{ getActualBiomeCount('saltwater').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #4080ff; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Freshwater (Lakes/Rivers)</strong><br>
              {{ getActualBiomePercentage('freshwater').toFixed(1) }}% 
              ({{ getActualBiomeCount('freshwater').toLocaleString() }} tiles)</span>
          </div>
        </div>
      </div>

      <!-- Forest Biomes -->
      <div style="margin-bottom: 15px;">
        <h5 style="margin-bottom: 10px; color: #228B22; border-bottom: 2px solid #228B22; padding-bottom: 5px;">üå≤ Forest Ecosystems</h5>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #0d4f0d; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Boreal Forest</strong><br>
              {{ getActualBiomePercentage('borealForest').toFixed(1) }}% 
              <span *ngIf="enforceEarthQuotas" style="color: #666;">(Target: {{ getTargetBiomePercentage('borealForest').toFixed(1) }}%) {{ getQuotaStatus('borealForest') }}</span><br>
              ({{ getActualBiomeCount('borealForest').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #228B22; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Temperate Forest</strong><br>
              {{ getActualBiomePercentage('temperateForest').toFixed(1) }}% 
              ({{ getActualBiomeCount('temperateForest').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #32CD32; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Tropical Rainforest</strong><br>
              {{ getActualBiomePercentage('tropicalRainforest').toFixed(1) }}% 
              ({{ getActualBiomeCount('tropicalRainforest').toLocaleString() }} tiles)</span>
          </div>
        </div>
      </div>

      <!-- Grassland Biomes -->
      <div style="margin-bottom: 15px;">
        <h5 style="margin-bottom: 10px; color: #90EE90; border-bottom: 2px solid #90EE90; padding-bottom: 5px;">üåæ Grasslands & Savannas</h5>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #90EE90; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Temperate Grassland</strong><br>
              {{ getActualBiomePercentage('temperateGrassland').toFixed(1) }}% 
              ({{ getActualBiomeCount('temperateGrassland').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #D2B48C; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Savanna</strong><br>
              {{ getActualBiomePercentage('savanna').toFixed(1) }}% 
              ({{ getActualBiomeCount('savanna').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #9ACD32; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Scrub & Shrublands</strong><br>
              {{ getActualBiomePercentage('scrub').toFixed(1) }}% 
              ({{ getActualBiomeCount('scrub').toLocaleString() }} tiles)</span>
          </div>
        </div>
      </div>

      <!-- Extreme Biomes -->
      <div style="margin-bottom: 15px;">
        <h5 style="margin-bottom: 10px; color: #D2691E; border-bottom: 2px solid #D2691E; padding-bottom: 5px;">üèîÔ∏è Extreme Environments</h5>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #D2691E; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Deserts</strong><br>
              {{ getActualBiomePercentage('deserts').toFixed(1) }}% 
              <span *ngIf="enforceEarthQuotas" style="color: #666;">(Target: {{ getTargetBiomePercentage('deserts').toFixed(1) }}%) {{ getQuotaStatus('deserts') }}</span><br>
              ({{ getActualBiomeCount('deserts').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #A9A9A9; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Tundra</strong><br>
              {{ getActualBiomePercentage('tundra').toFixed(1) }}% 
              ({{ getActualBiomeCount('tundra').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #696969; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Mountains</strong><br>
              {{ getActualBiomePercentage('mountains').toFixed(1) }}% 
              ({{ getActualBiomeCount('mountains').toLocaleString() }} tiles)</span>
          </div>
        </div>
      </div>

      <!-- Human Use Areas -->
      <div style="margin-bottom: 10px;">
        <h5 style="margin-bottom: 10px; color: #8B4513; border-bottom: 2px solid #8B4513; padding-bottom: 5px;">üè° Human Use Areas</h5>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 8px;">
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #DAA520; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Cropland</strong><br>
              {{ getActualBiomePercentage('cropland').toFixed(1) }}% 
              ({{ getActualBiomeCount('cropland').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #6B8E23; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Pastureland</strong><br>
              {{ getActualBiomePercentage('pastureland').toFixed(1) }}% 
              ({{ getActualBiomeCount('pastureland').toLocaleString() }} tiles)</span>
          </div>
          <div style="display: flex; align-items: center; padding: 4px;">
            <div style="width: 20px; height: 20px; background: #2F4F4F; border: 1px solid #ccc; margin-right: 8px; border-radius: 3px;"></div>
            <span style="font-size: 13px;"><strong>Urban Areas</strong><br>
              {{ getActualBiomePercentage('urban').toFixed(1) }}% 
              ({{ getActualBiomeCount('urban').toLocaleString() }} tiles)</span>
          </div>
        </div>
      </div>

      <!-- Summary Stats -->
      <div style="margin-top: 15px; padding: 10px; background: #e9ecef; border-radius: 5px;">
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 10px; font-size: 12px;">
          <div><strong>Total Water:</strong><br>
            {{ (getActualBiomePercentage('saltwater') + getActualBiomePercentage('freshwater')).toFixed(1) }}%<br>
            ({{ (getActualBiomeCount('saltwater') + getActualBiomeCount('freshwater')).toLocaleString() }} tiles)
          </div>
          <div><strong>Total Land:</strong><br>
            {{ (100 - (getActualBiomePercentage('saltwater') + getActualBiomePercentage('freshwater'))).toFixed(1) }}%<br>
            ({{ (populationBasedMapSize * populationBasedMapSize - getActualBiomeCount('saltwater') - getActualBiomeCount('freshwater')).toLocaleString() }} tiles)
          </div>
          <div><strong>Agricultural Land:</strong><br>
            {{ (getActualBiomePercentage('cropland') + getActualBiomePercentage('pastureland')).toFixed(1) }}%<br>
            ({{ (getActualBiomeCount('cropland') + getActualBiomeCount('pastureland')).toLocaleString() }} tiles)
          </div>
          <div><strong>Natural Areas:</strong><br>
            {{ (100 - (getActualBiomePercentage('saltwater') + getActualBiomePercentage('freshwater') + getActualBiomePercentage('cropland') + getActualBiomePercentage('pastureland') + getActualBiomePercentage('urban'))).toFixed(1) }}%<br>
            ({{ (populationBasedMapSize * populationBasedMapSize - getActualBiomeCount('saltwater') - getActualBiomeCount('freshwater') - getActualBiomeCount('cropland') - getActualBiomeCount('pastureland') - getActualBiomeCount('urban')).toLocaleString() }} tiles)
          </div>
        </div>
        <div style="margin-top: 10px; padding-top: 8px; border-top: 1px solid #ccc; font-size: 11px; color: #666;">
          <strong>Map Scale:</strong> {{ populationBasedMapSize }}√ó{{ populationBasedMapSize }} = {{ (populationBasedMapSize * populationBasedMapSize).toLocaleString() }} total tiles (1 tile = 1 m¬≤)
        </div>
      </div>
    </div>

    <!-- Terrain Generation Controls -->
    <div class="terrain-controls" *ngIf="showTerrainControls" style="margin-bottom: 20px; padding: 15px; background: #f1f8ff; border-radius: 8px; border: 2px solid #b3d9ff;">
      <h4 style="margin-top: 0; margin-bottom: 15px; color: #2c5aa0; text-align: center;">üó∫Ô∏è Natural Terrain Generation</h4>
      
        <div style="display: flex; flex-direction: column; gap: 12px;">
        <!-- Earth Quota Toggle -->
        <div style="background: white; padding: 12px; border-radius: 4px; border: 1px solid #ddd;">
          <label style="display: flex; align-items: center; cursor: pointer; font-weight: 600; color: #2c5aa0;">
            <input 
              type="checkbox" 
              [(ngModel)]="enforceEarthQuotas" 
              (change)="updateMap()" 
              style="margin-right: 8px; transform: scale(1.2);"
            />
            üåç Enforce Earth-Based Biome Percentages
          </label>
          <div style="font-size: 12px; color: #666; margin-top: 4px; margin-left: 24px;">
            When enabled, maintains exact Earth percentages while preserving natural clustering
          </div>
        </div>

        <div style="text-align: center;">
          <button 
            (click)="regenerateTerrain()" 
            style="
              background: linear-gradient(135deg, #4a90e2, #357abd);
              color: white;
              border: none;
              padding: 12px 24px;
              border-radius: 6px;
              font-size: 14px;
              font-weight: 600;
              cursor: pointer;
              box-shadow: 0 3px 8px rgba(0,0,0,0.2);
              transition: all 0.3s ease;
            "
            onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 5px 15px rgba(0,0,0,0.3)'"
            onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 3px 8px rgba(0,0,0,0.2)'"
          >
            üé≤ Generate New {{ enforceEarthQuotas ? 'Earth-Accurate' : 'Natural' }} Island Layout
          </button>
        </div>        <div style="background: white; padding: 10px; border-radius: 4px; border: 1px solid #ddd; font-size: 13px;">
          <div style="font-weight: 600; margin-bottom: 6px; color: #2c5aa0;">üåø Enhanced Features:</div>
          <ul style="margin: 0; padding-left: 18px; line-height: 1.4;">
            <li><strong>Earth-Based Quotas:</strong> Optional enforcement of exact Earth biome percentages</li>
            <li><strong>Realistic Biome Clustering:</strong> Natural seed-based biome distribution</li>
            <li><strong>Elevation-Based Terrain:</strong> Mountains, foothills, and coastal areas</li>
            <li><strong>Natural Water Systems:</strong> Rivers flowing from mountains to coast</li>
            <li><strong>Geographic Logic:</strong> Rain shadows, coastal zones, and transition areas</li>
            <li><strong>Smart Fallbacks:</strong> Maintains natural look when quotas are exceeded</li>
          </ul>
          <div style="margin-top: 8px; padding: 6px; background: #f8f9fa; border-radius: 3px; font-size: 12px;">
            <strong>Mode:</strong> {{ enforceEarthQuotas ? 'üåç Earth-Accurate (exact percentages)' : 'üèùÔ∏è Natural Clustering (organic distribution)' }}
          </div>
        </div>
        
        <div style="text-align: center; font-size: 12px; color: #666; font-style: italic;">
          Current Terrain Seed: {{ terrainSeed.toFixed(0) }}
        </div>
      </div>
    </div>
    
    <!-- Debug Controls -->
    <div class="debug-controls" style="margin-bottom: 20px; padding: 10px; background: #f5f5f5; border-radius: 5px;">
      <h4>Debug Tools</h4>
      <button (click)="updateMap()" style="padding: 8px 16px; margin-right: 10px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">
        üîÑ Regenerate Current Terrain
      </button>
      <button (click)="regenerateTerrain()" style="padding: 8px 16px; margin-right: 10px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer;">
        üé≤ New Terrain Pattern
      </button>
    </div>
      
    <!-- Population-Based Map Sizing -->
    <div class="population-controls">
      <h4>Population-Based Map Sizing</h4>
      <label>
        <input type="checkbox" [(ngModel)]="usePopulationSizing" (change)="updateMap()" />
        Use Population-Based Map Size
      </label>
      <label>
        Year:
        <input type="number" min="1800" max="2050" [(ngModel)]="selectedYear" (input)="updateMap()" />
      </label>
      <div class="population-info" *ngIf="usePopulationSizing">
        <small>
          <strong>Population in {{ selectedYear }}: {{ getWorldPopulation(selectedYear).toLocaleString() }}</strong><br><br>
          
          <strong>Total Earth Surface Per Person:</strong><br>
          ‚Ä¢ Total area (inc. oceans): {{ totalAreaPerPerson.toLocaleString() }} m¬≤<br>
          ‚Ä¢ Ocean area: {{ oceanAreaPerPerson.toLocaleString() }} m¬≤ (70.9%)<br>
          ‚Ä¢ Total land area: {{ squareMetersPerPerson.toLocaleString() }} m¬≤ (29.1%)<br><br>
          
          <strong>Biome Breakdown Per Person:</strong><br>
          ‚Ä¢ Saltwater (oceans/seas): {{ landBreakdownPerPerson['saltwater'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Freshwater (lakes/rivers): {{ landBreakdownPerPerson['freshwater'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Boreal Forest: {{ landBreakdownPerPerson['borealForest'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Temperate Forest: {{ landBreakdownPerPerson['temperateForest'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Tropical Rainforest: {{ landBreakdownPerPerson['tropicalRainforest'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Temperate Grassland: {{ landBreakdownPerPerson['temperateGrassland'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Savanna: {{ landBreakdownPerPerson['savanna'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Tundra: {{ landBreakdownPerPerson['tundra'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Deserts: {{ landBreakdownPerPerson['deserts'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Mountains: {{ landBreakdownPerPerson['mountains'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Pastureland: {{ landBreakdownPerPerson['pastureland'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Cropland: {{ landBreakdownPerPerson['cropland'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Scrub: {{ landBreakdownPerPerson['scrub'].toLocaleString() }} m¬≤<br>
          ‚Ä¢ Urban Areas: {{ landBreakdownPerPerson['urban'].toLocaleString() }} m¬≤<br><br>
          
          <strong style="color: #ff6b35;">Actually usable for living: {{ usableAreaPerPerson.toLocaleString() }} m¬≤ (~11% of land)</strong><br><br>
          
          <strong>Natural Island Terrain Layout:</strong><br>
          ‚Ä¢ <span style="color: #4682B4;">Ocean & Lakes</span> ‚Üí Blue water terrain (outer ocean + inland lakes/rivers)<br>
          ‚Ä¢ <span style="color: #D2691E;">Coastal Deserts</span> ‚Üí Sandy beaches and arid coastal zones<br>
          ‚Ä¢ <span style="color: #228B22;">Temperate Forests</span> ‚Üí Dense green forest zones<br>
          ‚Ä¢ <span style="color: #90EE90;">Grasslands & Pastures</span> ‚Üí Green meadows and agricultural valleys<br>
          ‚Ä¢ <span style="color: #696969;">Mountains & Peaks</span> ‚Üí Rocky highland terrain<br>
          ‚Ä¢ <span style="color: #8B4513;">Cropland & Valleys</span> ‚Üí Brown agricultural and valley terrain<br>
          ‚Ä¢ <span style="color: #2F4F4F;">Urban Centers</span> ‚Üí Stone urban development<br><br>
          
          <strong>Geographic Layout:</strong><br>
          The terrain shows a tiny island surrounded by vast ocean (accurate Earth proportions):<br>
          ‚Ä¢ Massive ocean covers ~80% of the map area (matching real Earth ratios)<br>
          ‚Ä¢ Very small island with compressed biomes in realistic proportions<br>
          ‚Ä¢ Minimal coastal zones due to small land area<br>
          ‚Ä¢ Concentrated agricultural areas in the few fertile valleys<br>
          ‚Ä¢ Small forest patches in mid-elevation zones<br>
          ‚Ä¢ Compact mountain range in the tiny interior<br>
          ‚Ä¢ Scaled-down freshwater system (small lakes and streams)<br>
          ‚Ä¢ Tiny urban center represents the limited habitable space<br>
          ‚Ä¢ **This is what your fair share of Earth actually looks like!**<br><br>
          
          <strong>Map Visualization:</strong><br>
          ‚Ä¢ Each tile: 1m √ó 1m<br>
          ‚Ä¢ Map size: {{ populationBasedMapSize }}√ó{{ populationBasedMapSize }} tiles<br>
          ‚Ä¢ Represents: {{ (populationBasedMapSize * populationBasedMapSize).toLocaleString() }} m¬≤ (1:1 scale)<br>
          ‚Ä¢ Total Earth surface per person: {{ totalAreaPerPerson.toLocaleString() }} m¬≤ (includes oceans, land, everything)<br>
          ‚Ä¢ Scale: **TRUE 1:1 SCALE** - Each map square meter = 1 real square meter of your Earth share!
        </small>
      </div>
      
      <!-- Terrain Percentage Verification -->
      <div class="terrain-comparison" *ngIf="usePopulationSizing && actualTerrainPercentages.stone > 0">
        <h5 style="margin-top: 20px; color: #ff6b35;">Map Accuracy Verification</h5>
        <small>
          <strong>Actual vs Expected Terrain Distribution:</strong><br>
          <table style="width: 100%; border-collapse: collapse; margin-top: 10px;">
            <tr style="background-color: #f0f0f0;">
              <th style="padding: 5px; border: 1px solid #ccc; text-align: left;">Terrain Type</th>
              <th style="padding: 5px; border: 1px solid #ccc; text-align: center;">Actual %</th>
              <th style="padding: 5px; border: 1px solid #ccc; text-align: center;">Expected %</th>
              <th style="padding: 5px; border: 1px solid #ccc; text-align: center;">Difference</th>
            </tr>
            <tr>
              <td style="padding: 5px; border: 1px solid #ccc;"><span style="color: #696969;">Stone (Mountains/Urban)</span></td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ actualTerrainPercentages.stone }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ expectedTerrainPercentages.stone }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;" 
                  [style.color]="getAbsDifference(actualTerrainPercentages.stone, expectedTerrainPercentages.stone) > 2 ? 'red' : 'green'">
                {{ (actualTerrainPercentages.stone - expectedTerrainPercentages.stone).toFixed(1) }}%
              </td>
            </tr>
            <tr>
              <td style="padding: 5px; border: 1px solid #ccc;"><span style="color: #8B4513;">Dirt (Cropland/Scrub)</span></td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ actualTerrainPercentages.dirt }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ expectedTerrainPercentages.dirt }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;" 
                  [style.color]="getAbsDifference(actualTerrainPercentages.dirt, expectedTerrainPercentages.dirt) > 2 ? 'red' : 'green'">
                {{ (actualTerrainPercentages.dirt - expectedTerrainPercentages.dirt).toFixed(1) }}%
              </td>
            </tr>
            <tr>
              <td style="padding: 5px; border: 1px solid #ccc;"><span style="color: #4682B4;">Water (Oceans/Lakes)</span></td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ actualTerrainPercentages.dirt2 }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ expectedTerrainPercentages.dirt2 }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;" 
                  [style.color]="getAbsDifference(actualTerrainPercentages.dirt2, expectedTerrainPercentages.dirt2) > 2 ? 'red' : 'green'">
                {{ (actualTerrainPercentages.dirt2 - expectedTerrainPercentages.dirt2).toFixed(1) }}%
              </td>
            </tr>
            <tr>
              <td style="padding: 5px; border: 1px solid #ccc;"><span style="color: #D2691E;">Sand (Deserts)</span></td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ actualTerrainPercentages.sand }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ expectedTerrainPercentages.sand }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;" 
                  [style.color]="getAbsDifference(actualTerrainPercentages.sand, expectedTerrainPercentages.sand) > 2 ? 'red' : 'green'">
                {{ (actualTerrainPercentages.sand - expectedTerrainPercentages.sand).toFixed(1) }}%
              </td>
            </tr>
            <tr>
              <td style="padding: 5px; border: 1px solid #ccc;"><span style="color: #228B22;">Grass (Forests/Grasslands)</span></td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ actualTerrainPercentages.grass }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;">{{ expectedTerrainPercentages.grass }}%</td>
              <td style="padding: 5px; border: 1px solid #ccc; text-align: center;" 
                  [style.color]="getAbsDifference(actualTerrainPercentages.grass, expectedTerrainPercentages.grass) > 2 ? 'red' : 'green'">
                {{ (actualTerrainPercentages.grass - expectedTerrainPercentages.grass).toFixed(1) }}%
              </td>
            </tr>
          </table>
          <br>
          <em>Green = Good match (within 2%), Red = Significant difference (>2%)</em>
        </small>
      </div>
    </div>
    
      
    </div>
  </div>
